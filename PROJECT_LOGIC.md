# AI æ–‡æª”ç”Ÿæˆå™¨ V3.0 - å°ˆæ¡ˆé‚è¼¯æ–‡æª”

## ðŸ“‹ ç›®éŒ„

1. [å°ˆæ¡ˆæ¦‚è¿°](#å°ˆæ¡ˆæ¦‚è¿°)
2. [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
3. [æŠ€è¡“æž¶æ§‹](#æŠ€è¡“æž¶æ§‹)
4. [è³‡æ–™æµç¨‹](#è³‡æ–™æµç¨‹)
5. [API ç«¯é»ž](#api-ç«¯é»ž)
6. [AI è§’è‰²è¨­å®šæª”ç³»çµ±](#ai-è§’è‰²è¨­å®šæª”ç³»çµ±)
7. [æˆæœ¬è¿½è¹¤ç³»çµ±](#æˆæœ¬è¿½è¹¤ç³»çµ±)
8. [SOP å„ªåŒ–æµç¨‹](#sop-å„ªåŒ–æµç¨‹)
9. [æµç¨‹åœ–ç”Ÿæˆ (Kroki)](#æµç¨‹åœ–ç”Ÿæˆ-kroki)
10. [ç›®éŒ„çµæ§‹](#ç›®éŒ„çµæ§‹)
11. [é…ç½®ç®¡ç†](#é…ç½®ç®¡ç†)

---

## å°ˆæ¡ˆæ¦‚è¿°

**AI æ–‡æª”ç”Ÿæˆå™¨ V3.0** æ˜¯ä¸€å€‹åŸºæ–¼ Flask çš„ Web æ‡‰ç”¨ç¨‹å¼ï¼Œåˆ©ç”¨ AIï¼ˆGoogle Gemini æˆ– OpenAI GPTï¼‰æ ¹æ“šç”¨æˆ¶æä¾›çš„æ¨¡æ¿å’Œéœ€æ±‚è‡ªå‹•ç”Ÿæˆå°ˆæ¥­æ–‡æª”ã€‚

### ä¸»è¦ç‰¹è‰²

- ðŸ¤– **AI è§’è‰²è¨­å®šæª”ç³»çµ±**ï¼šæ ¹æ“šæ–‡æª”é¡žåž‹è‡ªå‹•è¼‰å…¥å°ˆæ¥­è§’è‰²è¨­å®šï¼ˆ`PTT_PROFILE.md` / `SYS_PROFILE.md`ï¼‰
- ðŸ“Š **å¤šæ ¼å¼è¼¸å‡º**ï¼šæ”¯æŒ DOCXã€PPTXã€PDFã€Markdown
- ðŸ”„ **SOP å…¨æµç¨‹å„ªåŒ–**ï¼š
    - **å…§å®¹å„ªåŒ–**ï¼šAI æ™ºèƒ½é‡çµ„èˆ‡ç²¾ç°¡å…§å®¹
    - **åœ–ç‰‡æ³¨å…¥**ï¼šå¾Œè™•ç†ï¼ˆPost-Processingï¼‰æ–¹å¼å°‡åœ–ç‰‡ç²¾ç¢ºæ’å…¥æŒ‡å®šé é¢
- ðŸ’° **æˆæœ¬è¿½è¹¤**ï¼šè‡ªå‹•è¨˜éŒ„æ‰€æœ‰ AI è«‹æ±‚çš„ token ä½¿ç”¨é‡å’Œæˆæœ¬
- ðŸŽ¨ **ç¾ä»£åŒ– UI**ï¼šå°ˆæ¥­çš„æ¼¸å±¤è¨­è¨ˆèˆ‡å‹•ç•«æ•ˆæžœï¼Œæ”¯æŒå¤šä¸»é¡Œåˆ‡æ›
- â“ **å³æ™‚èªªæ˜Ž**ï¼šç¨ç«‹çš„ç³»çµ±æž¶æ§‹èªªæ˜Žé é¢ï¼Œæ”¯æŒ Markdown æ¸²æŸ“èˆ‡ç›®éŒ„å°Žèˆª
- ðŸ”’ **å®‰å…¨ç®¡ç†**ï¼šå¯†ç¢¼ä¿è­·çš„ API è¨­å®šé é¢
- ðŸ“Š **æµç¨‹åœ–ç”Ÿæˆ**ï¼šä½¿ç”¨ AI å°‡æ–‡å­—æè¿°è½‰æ›ç‚º Mermaid èªžæ³•ï¼Œå†é€éŽ Kroki API ç”Ÿæˆ PNG åœ–ç‰‡

---

## æ ¸å¿ƒåŠŸèƒ½

### 1. æ–‡æª”ç”Ÿæˆ

- **æ”¯æŒé¡žåž‹**ï¼š
  - ç³»çµ±æ–‡æª”ï¼ˆSystem Documentationï¼‰
  - SOP æ¨™æº–ä½œæ¥­ç¨‹åºï¼ˆStandard Operating Procedureï¼‰
  - æŠ€è¡“å ±å‘Šï¼ˆTechnical Reportï¼‰
  - SOP å„ªåŒ–ï¼ˆSOP Optimizationï¼‰

- **è¼¸å‡ºæ ¼å¼**ï¼š
  - Word (`.docx`)
  - PowerPoint (`.pptx`)
  - PDF (`.pdf`)
  - Markdown (`.md`)

### 2. AI éœ€æ±‚å„ªåŒ–

- ç”¨æˆ¶å¯é»žæ“Šã€Œâœ¨ AI å„ªåŒ–éœ€æ±‚ã€æŒ‰éˆ•
- AI æœƒæ ¹æ“šæ–‡æª”é¡žåž‹å’Œå°æ‡‰çš„ Profile å„ªåŒ–éœ€æ±‚æè¿°
- å„ªåŒ–çµæžœå¯ç·¨è¼¯ã€ç¢ºèªä½¿ç”¨æˆ–æ”¾æ£„

### 3. SOP åœ–ç‰‡æ³¨å…¥ (æ–°åŠŸèƒ½)

- **ç¨ç«‹çš„å·¥ä½œæµ**ï¼šä½æ–¼ã€Œå„ªåŒ–ç°¡å ±ã€Tab
- **å¾Œè™•ç†æ©Ÿåˆ¶**ï¼šé‡å°å·²ç”Ÿæˆçš„ç´”æ–‡å­— PPTX é€²è¡Œåœ–ç‰‡è£œå……
- **ç²¾ç¢ºæŽ§åˆ¶**ï¼šç”¨æˆ¶å¯ä¸Šå‚³åœ–ç‰‡ä¸¦æŒ‡å®šæ’å…¥çš„æŠ•å½±ç‰‡é ç¢¼
- **è‡ªå‹•æŽ’ç‰ˆ**ï¼šåœ–ç‰‡è‡ªå‹•ç¸®æ”¾ä¸¦æ”¾ç½®æ–¼æŠ•å½±ç‰‡å³å´å€åŸŸ

### 4. æ¨¡æ¿ç®¡ç†

- ä¸Šå‚³æ¨¡æ¿æ–‡ä»¶ï¼ˆPDF, DOCX, PPTX, TXTï¼‰
- è‡ªå‹•æå–æ–‡æœ¬å…§å®¹
- æ”¯æŒä¸­æ–‡æª”åï¼ˆä½¿ç”¨ `safe_filename` è™•ç†ï¼‰
- æŸ¥çœ‹ã€åˆªé™¤å·²ä¸Šå‚³æ¨¡æ¿

### 5. æ–‡æª”è¨˜éŒ„

- æŸ¥çœ‹æ‰€æœ‰ç”Ÿæˆçš„æ–‡æª”
- **æ–‡æª”ç¯©é¸**ï¼šæ”¯æŒæŒ‰ã€Œå…¨éƒ¨ã€ã€ã€Œç”Ÿæˆæ–‡æª”ã€ã€ã€Œå„ªåŒ–ç°¡å ±ã€ç¯©é¸
- æ‰¹é‡é¸æ“‡èˆ‡åˆªé™¤
- ä¸‹è¼‰å·²ç”Ÿæˆæ–‡æª”

### 6. AI æ¨¡åž‹è¨­å®š

- é¸æ“‡ AI å¼•æ“Žï¼šGemini / OpenAI / Mock
- é…ç½® OpenAI æ¨¡åž‹ï¼ˆgpt-4o, gpt-4o-mini ç­‰ï¼‰
- å¯†ç¢¼ä¿è­·çš„è¨­å®šé é¢
- UI ä¸»é¡Œåˆ‡æ›

### 7. ç³»çµ±èªªæ˜Ž

- **ç¨ç«‹é é¢**ï¼š`/help` è·¯ç”±æä¾›å®Œæ•´çš„ç³»çµ±æž¶æ§‹èªªæ˜Ž
- **å‹•æ…‹åŠ è¼‰**ï¼šå¾žå¾Œç«¯ API ç²å– Markdown å…§å®¹ä¸¦å‰ç«¯æ¸²æŸ“
- **ç›®éŒ„å°Žèˆª**ï¼šè‡ªå‹•ç”Ÿæˆç›®éŒ„ï¼Œæ”¯æŒé»žæ“Šè·³è½‰
- **å›žåˆ°é ‚éƒ¨**ï¼šé•·æ–‡æª”å‹å¥½çš„æ‡¸æµ®æŒ‰éˆ•

### 8. æµç¨‹åœ–ç”Ÿæˆ (æ–°åŠŸèƒ½)

- **AI é©…å‹•**ï¼šä½¿ç”¨ Gemini/OpenAI å°‡æ–‡å­—æµç¨‹æè¿°è½‰æ›ç‚º Mermaid èªžæ³•
- **Kroki æ•´åˆ**ï¼šé€éŽ Kroki API å°‡ Mermaid code æ¸²æŸ“ç‚ºé«˜å“è³ª PNG åœ–ç‰‡
- **å³æ™‚é è¦½**ï¼šç”Ÿæˆçš„æµç¨‹åœ–å¯åœ¨é é¢ä¸­ç›´æŽ¥é è¦½
- **å¯ç·¨è¼¯**ï¼šæ”¯æŒæ‰‹å‹•ç·¨è¼¯ Mermaid code å¾Œé‡æ–°ç”Ÿæˆ
- **ä¸‹è¼‰æ”¯æŒ**ï¼šç”Ÿæˆçš„ PNG å¯ç›´æŽ¥ä¸‹è¼‰ä½¿ç”¨

---

## æŠ€è¡“æž¶æ§‹

### å¾Œç«¯æž¶æ§‹

```
app/
â”œâ”€â”€ __init__.py          # Flask æ‡‰ç”¨åˆå§‹åŒ–
â”œâ”€â”€ routes.py            # API è·¯ç”±èˆ‡æ¥­å‹™é‚è¼¯
â”œâ”€â”€ services/            # æœå‹™å±¤
â”‚   â”œâ”€â”€ ai_service.py    # AI API èª¿ç”¨ï¼ˆGemini/OpenAIï¼‰
â”‚   â”œâ”€â”€ file_processor.py  # æ–‡ä»¶è™•ç†ï¼ˆæå–æ–‡æœ¬ï¼‰
â”‚   â”œâ”€â”€ format_converter.py  # æ ¼å¼è½‰æ›ï¼ˆMarkdown â†’ DOCX/PPTX/PDFï¼‰
â”‚   â”œâ”€â”€ ppt_injector.py    # PPTX åœ–ç‰‡æ³¨å…¥æœå‹™
â”‚   â””â”€â”€ kroki_service.py   # æµç¨‹åœ–ç”Ÿæˆæœå‹™ (Kroki API)
â””â”€â”€ utils/               # å·¥å…·å‡½æ•¸
    â””â”€â”€ helpers.py       # è¼”åŠ©å‡½æ•¸ï¼ˆsafe_filename, log_cost_to_fileï¼‰
```

### å‰ç«¯æž¶æ§‹

#### æŠ€è¡“æ£§

- **æ¡†æž¶**ï¼šåŽŸç”Ÿ HTML + CSS + JavaScript
- **UI åº«**ï¼šDaisyUI + Tailwind CSS
- **è¨­è¨ˆé¢¨æ ¼**ï¼šç¾ä»£åŒ–æ¼¸å±¤è¨­è¨ˆã€Glassmorphism
- **å­—é«”**ï¼šInter (Google Fonts)

#### æ¨¡çµ„åŒ–çµæ§‹

**HTML æª”æ¡ˆ**:
**HTML æª”æ¡ˆ**:
- `templates/index_v3_daisy.html` - ä¸»ç•Œé¢ (æ•´åˆ DaisyUI)
- `templates/help.html` - ç³»çµ±èªªæ˜Žé é¢ (ç¨ç«‹ï¼Œä½¿ç”¨ marked.js)

**CSS æ¨¡çµ„** (`static/css/`):
- `main.css` - åŸºç¤Žæ¨£å¼
- `components.css` - çµ„ä»¶æ¨£å¼
- `animations.css` - å‹•ç•«å®šç¾©

**JavaScript æ¨¡çµ„** (`static/js/`):
- `api.js` - API é…ç½®å’Œé€šç”¨å·¥å…·
- `ui.js` - UI äº¤äº’èˆ‡ Tab åˆ‡æ›
- `config.js` - æ¨¡åž‹é…ç½®ç®¡ç†
- `templates.js` - æ¨¡æ¿ç®¡ç†
- `documents.js` - æ–‡æª”è¨˜éŒ„ç®¡ç†
- `generate.js` - æ–‡æª”ç”Ÿæˆæ ¸å¿ƒé‚è¼¯
- `optimize.js` - SOP åœ–ç‰‡æ³¨å…¥é‚è¼¯
- `flowchart.js` - æµç¨‹åœ–ç”Ÿæˆé‚è¼¯ (æ–°)

---

## è³‡æ–™æµç¨‹

### 1. æ¨™æº–æ–‡æª”ç”Ÿæˆæµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ¶å¡«å¯«è¡¨å–®] --> B[é¸æ“‡æ–‡æª”é¡žåž‹]
    B --> C[é¸æ“‡æ¨¡æ¿]
    C --> D[è¼¸å…¥éœ€æ±‚æè¿°]
    D --> E{æ˜¯å¦ä½¿ç”¨ AI å„ªåŒ–?}
    E -->|æ˜¯| F[èª¿ç”¨ /api/optimize-requirements]
    F --> G[è¼‰å…¥å°æ‡‰ Profile]
    G --> H[AI å„ªåŒ–éœ€æ±‚]
    H --> I[ç”¨æˆ¶ç¢ºèªå„ªåŒ–çµæžœ]
    I --> J[èª¿ç”¨ /api/generate]
    E -->|å¦| J
    J --> K[è¼‰å…¥å°æ‡‰ Profile]
    K --> L[è®€å–æ¨¡æ¿å…§å®¹]
    L --> M[æ§‹å»º AI Prompt]
    M --> N[èª¿ç”¨ AI API]
    N --> O[ç”Ÿæˆ Markdown å…§å®¹]
    O --> P[æ ¼å¼è½‰æ›]
    P --> Q[ä¿å­˜æ–‡ä»¶]
    Q --> R[è¿”å›žä¸‹è¼‰é€£çµ]
```

### 2. SOP åœ–ç‰‡æ³¨å…¥æµç¨‹ (Post-Processing)

```mermaid
graph TD
    A[ç”¨æˆ¶é€²å…¥å„ªåŒ–ç°¡å ± Tab] --> B[é¸æ“‡å·²ç”Ÿæˆçš„ PPTX]
    B --> C[ä¸Šå‚³åœ–ç‰‡]
    C --> D[èª¿ç”¨ /api/stage_image]
    D --> E[åœ–ç‰‡æš«å­˜æ–¼ output/temp_images]
    E --> F[ç”¨æˆ¶æŒ‡å®šåœ–ç‰‡å°æ‡‰é ç¢¼]
    F --> G[é»žæ“Šç”Ÿæˆæ–°ç‰ˆæœ¬]
    G --> H[èª¿ç”¨ /api/inject_images]
    H --> I[PPTXInjector è®€å–åŽŸå§‹ PPTX]
    I --> J[éæ­·æ³¨å…¥é…ç½®]
    J --> K[å°‡åœ–ç‰‡æ’å…¥æŒ‡å®š Slide]
    K --> L[è‡ªå‹•èª¿æ•´åœ–ç‰‡å¤§å°èˆ‡ä½ç½®]
    L --> M[å¦å­˜ç‚º _v1.pptx]
    M --> N[è¿”å›žä¸‹è¼‰é€£çµ]
```

---

## API ç«¯é»ž

### ä¸»è¦ç«¯é»ž

| ç«¯é»ž | æ–¹æ³• | åŠŸèƒ½ | èªªæ˜Ž |
|------|------|------|------|
| `/` | GET | é¦–é  | æ¸²æŸ“ä¸»ç•Œé¢ |
| `/api/config` | GET/POST | API é…ç½® | è®€å–/ä¿å­˜ AI æ¨¡åž‹é…ç½® |
| `/api/generate` | POST | ç”Ÿæˆæ–‡æª” | æ ¹æ“šéœ€æ±‚ç”Ÿæˆæ–‡æª” |
| `/api/templates` | GET | ç²å–æ¨¡æ¿åˆ—è¡¨ | è¿”å›žæ‰€æœ‰å·²ä¸Šå‚³æ¨¡æ¿ |
| `/api/history` | GET | ç²å–ç”Ÿæˆè¨˜éŒ„ | è¿”å›žæ‰€æœ‰ç”Ÿæˆçš„æ–‡æª” |
| `/help` | GET | èªªæ˜Žé é¢ | æ¸²æŸ“ç³»çµ±æž¶æ§‹èªªæ˜Žé é¢ |
| `/api/help` | GET | ç²å–èªªæ˜Žå…§å®¹ | è¿”å›ž PROJECT_ARCHITECTURE.md çš„å…§å®¹ |
| `/api/stage_image` | POST | åœ–ç‰‡æš«å­˜ | ä¸Šå‚³åœ–ç‰‡ç”¨æ–¼å¾ŒçºŒæ³¨å…¥ |
| `/api/inject_images` | POST | åœ–ç‰‡æ³¨å…¥ | å°‡åœ–ç‰‡æ’å…¥ PPTX æŒ‡å®šé é¢ |
| `/api/generate-mermaid` | POST | ç”Ÿæˆ Mermaid | ä½¿ç”¨ AI å°‡æè¿°è½‰ç‚º Mermaid code (æ–°) |
| `/api/generate-flowchart` | POST | ç”Ÿæˆæµç¨‹åœ– | é€éŽ Kroki å°‡ Mermaid è½‰ç‚º PNG (æ–°) |
| `/api/generate-flowchart-full` | POST | ä¸€éµç”Ÿæˆ | å®Œæ•´æµç¨‹ï¼šæè¿° â†’ Mermaid â†’ PNG (æ–°) |

### æ–°å¢žç«¯é»žè©³ç´°èªªæ˜Ž

#### `/api/stage_image` (POST)

**åŠŸèƒ½**ï¼šæš«å­˜ä¸Šå‚³çš„åœ–ç‰‡ï¼Œè¿”å›žè‡¨æ™‚è·¯å¾‘

**è«‹æ±‚åƒæ•¸**ï¼š
- `image`: åœ–ç‰‡æ–‡ä»¶ (multipart/form-data)

**è¿”å›ž**ï¼š
```json
{
  "success": true,
  "filename": "åŽŸå§‹æª”å",
  "path": "çµ•å°è·¯å¾‘"
}
```

#### `/api/inject_images` (POST)

**åŠŸèƒ½**ï¼šå°‡æš«å­˜çš„åœ–ç‰‡æ³¨å…¥åˆ°æŒ‡å®šçš„ PPTX é é¢

**è«‹æ±‚åƒæ•¸**ï¼š
```json
{
  "filename": "source.pptx",
  "injections": [
    {
      "image_path": "/path/to/image1.png",
      "slide_number": 1
    },
    {
      "image_path": "/path/to/image2.png",
      "slide_number": 3
    }
  ]
}
```

**è¿”å›ž**ï¼š
```json
{
  "success": true,
  "filename": "source_v1.pptx",
  "download_url": "/api/download/source_v1.pptx"
}
```

---

## AI è§’è‰²è¨­å®šæª”ç³»çµ±

### Profile æ–‡ä»¶

#### 1. `PTT_PROFILE.md` - SOP ç°¡å ±å„ªåŒ–å°ˆå®¶

**é©ç”¨ç¯„åœ**ï¼š
- æ–‡æª”é¡žåž‹ç‚º `sop`ï¼ˆSOP æ¨™æº–ä½œæ¥­ç¨‹åºï¼‰
- æ–‡æª”é¡žåž‹ç‚º `sop_optimize`ï¼ˆSOP å„ªåŒ–ï¼‰

**æ ¸å¿ƒæŠ€èƒ½**ï¼š
- ç°¡å ±çµæ§‹å„ªåŒ–
- è¦–è¦ºå±¤æ¬¡è¨­è¨ˆ
- å…§å®¹ç²¾ç°¡èˆ‡é‡çµ„

#### 2. `SYS_PROFILE.md` - ERP ç³»çµ±æ–‡æª”ç”Ÿæˆå°ˆå®¶

**é©ç”¨ç¯„åœ**ï¼š
- æ–‡æª”é¡žåž‹ç‚º `system_doc`ï¼ˆç³»çµ±æ–‡æª”ï¼‰
- æ–‡æª”é¡žåž‹ç‚º `technical_report`ï¼ˆæŠ€è¡“å ±å‘Šï¼‰

**æ ¸å¿ƒæŠ€èƒ½**ï¼š
- ç³»çµ±æž¶æ§‹æ–‡æª”åŒ–
- æŠ€è¡“è¦æ ¼æ’°å¯«
- API æ–‡æª”ç”Ÿæˆ

---

## SOP å„ªåŒ–æµç¨‹

### é›™è»Œç­–ç•¥

ç‚ºäº†é”åˆ°æœ€ä½³æ•ˆæžœï¼Œç³»çµ±æŽ¡ç”¨ã€Œå…§å®¹ç”Ÿæˆã€èˆ‡ã€Œåœ–ç‰‡æ•´åˆã€åˆ†é›¢çš„ç­–ç•¥ï¼š

1.  **ç¬¬ä¸€éšŽæ®µï¼šå…§å®¹ç”Ÿæˆ (AI)**
    - ä½¿ç”¨ `PTT_PROFILE.md` æŒ‡å°Ž AI
    - å°ˆæ³¨æ–¼å°‡å‡Œäº‚çš„ SOP æ–‡æœ¬é‡çµ„ç‚ºçµæ§‹åŒ–çš„ç°¡å ±å¤§ç¶±
    - ç”Ÿæˆç´”æ–‡å­—çš„ PPTXï¼Œç¢ºä¿ç‰ˆé¢æ•´æ½”

2.  **ç¬¬äºŒéšŽæ®µï¼šåœ–ç‰‡æ³¨å…¥ (Post-Processing)**
    - ä½¿ç”¨ã€Œå„ªåŒ–ç°¡å ±ã€Tab
    - ç”¨æˆ¶æ‰‹å‹•ä¸Šå‚³é—œéµåœ–ç‰‡ä¸¦æŒ‡å®šé ç¢¼
    - ç³»çµ±è‡ªå‹•å°‡åœ–ç‰‡æ’å…¥åˆ° Slide çš„å³å´å€åŸŸï¼ˆä½”æ¯”ç´„ 45%ï¼‰
    - ç¢ºä¿åœ–ç‰‡ä¸æœƒé®æ“‹å·¦å´çš„æ–‡å­—å…§å®¹

é€™ç¨®æ–¹å¼è§£æ±ºäº† AI é›£ä»¥ç²¾ç¢ºæŽ§åˆ¶åœ–ç‰‡ä½ç½®çš„å•é¡Œï¼ŒåŒæ™‚ä¿ç•™äº† AI åœ¨å…§å®¹æ•´ç†ä¸Šçš„å„ªå‹¢ã€‚

---

## ç›®éŒ„çµæ§‹

```
doc_generator_v3/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ ppt_injector.py    # PPTX åœ–ç‰‡æ³¨å…¥æœå‹™
â”‚   â”‚   â”œâ”€â”€ kroki_service.py   # æµç¨‹åœ–ç”Ÿæˆæœå‹™ (Kroki API)
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ routes.py              # API è·¯ç”±
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ index_v3_daisy.html    # ä¸»ç•Œé¢
â”‚   â””â”€â”€ help.html              # èªªæ˜Žé é¢
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ optimize.js        # åœ–ç‰‡æ³¨å…¥å‰ç«¯é‚è¼¯
â”‚   â”‚   â”œâ”€â”€ flowchart.js       # æµç¨‹åœ–ç”Ÿæˆå‰ç«¯é‚è¼¯
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ css/
â”œâ”€â”€ output/                    # ç”Ÿæˆçµæžœ
â”‚   â””â”€â”€ temp_images/           # è‡¨æ™‚åœ–ç‰‡å­˜å„²
â”œâ”€â”€ PTT_PROFILE.md             # SOP å°ˆå®¶è§’è‰²
â”œâ”€â”€ SYS_PROFILE.md             # ç³»çµ±å°ˆå®¶è§’è‰²
â”œâ”€â”€ PROJECT_LOGIC.md           # æœ¬æ–‡æª”
â””â”€â”€ run.py                     # å•Ÿå‹•è…³æœ¬
```

---

## æµç¨‹åœ–ç”Ÿæˆ (Kroki)

### åŠŸèƒ½æ¦‚è¿°

æµç¨‹åœ–ç”ŸæˆåŠŸèƒ½å…è¨±ç”¨æˆ¶é€éŽè‡ªç„¶èªžè¨€æè¿°æµç¨‹ï¼Œç³»çµ±æœƒè‡ªå‹•ï¼š
1. ä½¿ç”¨ AI å°‡æè¿°è½‰æ›ç‚º Mermaid èªžæ³•
2. é€éŽ Kroki API å°‡ Mermaid æ¸²æŸ“ç‚º PNG åœ–ç‰‡

### æŠ€è¡“å¯¦ç¾

#### KrokiService (`app/services/kroki_service.py`)

```python
class KrokiService:
    KROKI_URL = "https://kroki.io/mermaid/png"
    
    def generate_mermaid_prompt(description: str) -> str
    def convert_mermaid_to_png(mermaid_code: str) -> tuple[bytes, str]
    def save_png(png_data: bytes, filename: str = None) -> str
    def generate_flowchart(mermaid_code: str) -> dict
```

#### API ç«¯é»ž

| ç«¯é»ž | åŠŸèƒ½ |
|------|------|
| `/api/generate-mermaid` | AI ç”Ÿæˆ Mermaid code |
| `/api/generate-flowchart` | Kroki è½‰æ›ç‚º PNG |
| `/api/generate-flowchart-full` | ä¸€éµå®Œæ•´æµç¨‹ |

### ä½¿ç”¨æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ¶è¼¸å…¥æµç¨‹æè¿°] --> B[é»žæ“Šç”Ÿæˆ Mermaid Code]
    B --> C[AI ç”Ÿæˆ Mermaid èªžæ³•]
    C --> D[é¡¯ç¤ºå¯ç·¨è¼¯çš„ Mermaid Code]
    D --> E[ç”¨æˆ¶å¯é¸æ“‡ç·¨è¼¯]
    E --> F[é»žæ“Šç”Ÿæˆ PNG]
    F --> G[Kroki API æ¸²æŸ“]
    G --> H[é¡¯ç¤ºæµç¨‹åœ–é è¦½]
    H --> I[ä¸‹è¼‰ PNG åœ–ç‰‡]
```

